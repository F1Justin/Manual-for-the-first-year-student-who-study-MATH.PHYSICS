\special{dvipdfmx:config z 0}
\documentclass{ctexbook}
\usepackage[svgnames]{xcolor}
\usepackage{tabularray}

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsfonts}

\usepackage{fontspec}

\usepackage{listings}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{tcolorbox}
\usepackage{tikz}

\usepackage{fvextra}
\usepackage{longtable}
\usepackage{calc}
\usepackage{pgfplots}
\usepackage{pifont}
\usepackage{setspace}
\usepackage{ulem}
\usepackage{enumitem}
\usepackage{mleftright}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\usepackage{unicode-math}

\usepackage{setspace}
\usepackage{multicol}
\usepackage{titletoc}
\usepackage{tocloft}
\usepackage{mathtools}
\usepackage{xeCJKfntef}

\usepackage{fancyhdr}
\usepackage[top=1.16in,bottom=1.34in,outer=1in,inner=1.2in]{geometry}

\usepackage[square]{natbib}
\def\em{\bfseries}
\def\bibname{参考与提及的文献}


\graphicspath{{./images/}}
\usepackage[
    colorlinks,
    linkcolor = DarkTurquoise!60!black,
    anchorcolor = OrangeRed,
    filecolor = Navy,
    backref = true,
    urlcolor = Navy,
    citecolor = darkgray,
    linktocpage,
    pagebackref = true,
    hyperfootnotes = true,
    breaklinks = true,
]{hyperref}
\ctexset{section={
      name={第,节},
      number=\chinese{section},
      format=\Large\bfseries\raggedright
     },
    subsection={
            number = {（\chinese{subsection}）},
        },
    subsubsection={
            number = {\arabic{subsubsection}},
        }
}






\definecolor{macred}{HTML}{fc5450}
\definecolor{macyellow}{HTML}{e0a22d}
\definecolor{macgreen}{HTML}{24cd4c}
\definecolor{mmagray}{HTML}{d7d7d7}
\definecolor{EE6743}{HTML}{EE6743}

\tcbuselibrary{breakable}
\tcbuselibrary{skins}
\tcbset{breakable, enhanced jigsaw, fonttitle = \bfseries}

\usetikzlibrary{patterns}
\usetikzlibrary{shadings}

\setsansfont{Noto Sans}
\setmonofont{iosevka-regular.ttf}[ItalicFont = iosevka-italic.ttf, RawFeature = {Ligatures = {}}]

\setCJKmainfont{Noto Serif CJK SC}[
    ItalicFont = FZKaiS-Extended,
    BoldItalicFont = FZKaiS-Extended
]
\setCJKsansfont{Noto Sans CJK SC}[ItalicFont = FZKaiS-Extended]
\setCJKmonofont{Noto Sans CJK SC}

\newcommand\chapterbox[1]{%
    \begin{tcbox}[on line,
            outer arc = 2pt,
            colback = green!45!blue!50!black,
            boxsep = 0pt,
            left = 4pt,
            right = 4pt,
            top = 2.5pt,
            bottom = 2pt,
            boxrule = 0pt,
            arc = 2pt,
            colupper = white
        ]
        {#1}
    \end{tcbox}\hfill}

\setmathfont{texgyrepagella-math.otf}
\setmathfont{STIXTwoMath-Regular.otf}[range = {"1D49C-"1D4CF, "0212F-"02134, "0212C}]

\xeCJKsetup{CheckSingle = true}
\def\addauthor#1{\addtocontents{toc}{\protect\vskip-17pt\protect\mbox{\hspace*{\textwidth - 13em}\itshape\color{gray}\footnotesize \underline{Author\,{\normalsize\(|\)}\footnotesize #1}}\par\bigskip}}

\fancypagestyle{mainlatter}{
    \fancyfoot[C]{\thepage}
}

\setlist[itemize, 2]{label = \(\circ\)}

\setmainfont{texgyrepagella-regular.otf}[BoldFont = texgyrepagella-bold.otf, ItalicFont = texgyrepagella-italic.otf, BoldItalicFont = texgyrepagella-bolditalic.otf, SlantedFont = TeXGyrePagellaX-Slanted.otf]

\def\cftdot{$\cdot$}

\makeatletter
\renewcommand\cftchapfont{\bfseries}
\renewcommand\cftchapleader{}
\renewcommand\cftchapafterpnum{}
\renewcommand\cftchappagefont{\Large\bfseries}
\renewcommand\cftchapfillnum[1]{{\cftchapleader}{\makebox[\@pnumwidth][\cftpnumalign]{{\cftchappagefont #1}}\cftchapafterpnum\par}}
\renewcommand\cftchapfont[1]{%
    \begin{tcbox}[on line,
            outer arc=2pt,colback=green!45!blue!50!black,
            boxsep=0pt,left=4pt,right=4pt,top=2.5pt,bottom=2pt,
            boxrule=0pt,arc = 2pt,  colupper = white]
        {\bfseries #1}
    \end{tcbox}\hfill}
\renewcommand\cftsecindent{3.8em}
\renewcommand\cftsecfont{\color{black}\slshape}
\renewcommand\cftsecleader{\cftdotfill\cftdotsep}
\renewcommand\cftsecafterpnum{\hspace*{2em}\par\medskip}
\renewcommand\cftsecdotsep{0.05mu}
\renewcommand\cftsecpagefont{\itshape\sffamily}

\def\contentsname{\Huge 目录\\ \LARGE
    Contents
    \bigskip\noindent}

\newcounter{mma}
\setcounter{mma}{0}
\def\mmain{\stepcounter{mma}\texttt{\color{gray}In[\arabic{mma}]:=}\ignorespaces}
\def\mmaout{\texttt{\color{gray}Out[\arabic{mma}]={ }}}

\renewcommand{\figureautorefname}{图}
\renewcommand{\tableautorefname}{表}

\newtcolorbox{notebook}[1]{
    colframe = lightgray!70!white,
    title = {
            \begin{tikzpicture}
                \filldraw[macred] (0, 0) circle (0.3em);
                \filldraw[macyellow!80!white] (0.5, 0) circle (0.3em);
                \filldraw[macgreen] (1, 0) circle (0.3em);
            \end{tikzpicture}%
            \hfill{\footnotesize\sffamily #1}\hfill%
            \phantom{
                \begin{tikzpicture}
                    \filldraw[macred] (0, 0) circle (0.3em);
                    \filldraw[macyellow!80!white] (0.5, 0) circle (0.3em);
                    \filldraw[macgreen] (1, 0) circle (0.3em);
                \end{tikzpicture}
            }
        }, coltitle = black, segmentation style = {draw = lightgray!70!white,very thick, solid}
}

\newtcolorbox{titleing}{
    enhanced,sharp corners=uphill,
    colback=red!30!white,colframe=red!70,coltext=black!75!white,
    arc=5mm,boxrule=1.5mm,boxsep=0mm,width=8cm,
    borderline={0.2mm}{0.2mm}{white}
}

\newtcolorbox{codeing}{
    colback = gray!30!white,
    colframe = white,
    boxsep = 0.0mm,
    sharp corners,
}

\long\def\mathematica#1#2{
    \begin{notebook}{八云蓝的挑战 - Wolfram Mathematica 13.1}
        \def\textit##1{{\itshape\color[HTML]{3c7d9e}##1}}
        \def\texttt##1{{\color[HTML]{002cc3}##1}}
        \def\tab{\phantom{\ttfamily abcd}}
        {\ttfamily\mmain\def\^{{\char"005E}}\def\@{{\char"0040}}\def\~{{\char"007E}}
        #1}
        \tcblower
        \mmaout#2
    \end{notebook}
}
\pgfplotsset{
        table/search path={./Plots},
    }
\usepgfplotslibrary{polar}

\def\CTEX@part@pagestyle{empty}

\newtheorem{example}{\indent 例}
\theoremstyle{definition}
\newtheorem*{solve}{\indent 解}
\newtheorem*{prove}{\indent 证明}

\let\left\mleft
\let\right\mright
\lstset{
    basicstyle = \ttfamily,
    language = [latex]tex,
    commentstyle = \color[HTML]{888888}\textit,
    columns = fixed,
    basewidth = 0.5em,
    breaklines,
    keepspaces
}
\setcounter{tocdepth}{1}

\makeatother

\linespread{1.4}
\def\subsubsectionautorefname{第\chinese{section}节}
\begin{document}




\mbox{}\thispagestyle{empty}\vfill
\begin{spacing}{1}\sffamily
    \begin{tblr}{colspec = {XX}, width = \textwidth}
        \textbf{新~生~手~册}                           &                  \\
        八云的魔法书\quad 出品                         &                  \\
        {}                                             &                  \\
        策划：小飞舞                                   &                  \\
        校对：……                                       & 排版：云与星与歌 \\
        {}                                             &                  \\
        作者（按作品先后为序）：                       &                  \\
        云与星与歌、食人妖怪、山舞银蛇、小飞舞、小麻雀 &                  \\
        {}                                             &                  \\
        仓库链接：                                     &                  \\
        ……                                             &                  \\
        更新时间：\today
    \end{tblr}
\end{spacing}


\setlength{\lineskip}{5pt}
\setlength{\lineskiplimit}{2.5pt}\setcounter{page}{0}
\pagestyle{empty}\newpage

\begin{spacing}{1}
    \vspace*{4em}
    \tableofcontents

\end{spacing}


\pagestyle{mainlatter}

\setCJKfamilyfont{zhkai}{FZKaiS-Extended-1.ttf}

\clearpage
\setcounter{page}{0}
\thispagestyle{empty}


\input{includes/初等数学知识拾遗.tex}
% \input{includes/宇佐见堇子的 LaTeX 之旅.tex}
% \input{includes/数分高代在学什么？.tex}
% \input{includes/幻想乡工程技术见闻录.tex}
% \input{includes/靛蓝的红枫.tex}
% \input{includes/Mathematica ~ 一切都是表达式.tex}



\bibliographystyle{apalike}
\small
\bibliography{cite}

\end{document}